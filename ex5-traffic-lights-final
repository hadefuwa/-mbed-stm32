#include "mbed.h"
#include "platform/mbed_thread.h"

DigitalIn SW1 = (A0);
DigitalIn SW2 = (A1);
BusOut myLEDs((D2), (D3), (D4), (D5), (D6), (D7));

/*
    Respond to switches 1 (A0) & 2 (A1)
    so that the lights remain in r1g2 state until switch 1 is pressed 
    and the r2g1 state until switch 2 is pressed
    
*/

#define blinkRate 1000

int main()
{
    SW1.mode(PullUp);
    SW2.mode(PullUp);
    
    while (true) 
    {
        myLEDs = 0x0c;
        thread_sleep_for(blinkRate);        
        myLEDs = 0x0c;
        thread_sleep_for(blinkRate);
        myLEDs = 0x0c;
        thread_sleep_for(blinkRate);
        
        /*
            insert a while loop with the condition to repeat
            while the pin corresponding to second switch is high 
            (this corresponds to the sensor on road 2
            not detecting any traffic). So, while the switch is not 
            pressed and the state of pin is high/3.3V,
            the loop is repeated as condition is true. 
            When the switch is pressed, the state of pin becomes
            low (so condition is now false) and the loop is exited. 
            This can be done using the code:
            while(SW2);
        
        */
        
        while(SW2 == 0)
        {
            myLEDs = 0x0a;
            thread_sleep_for(blinkRate);        
            myLEDs = 0x09;
            thread_sleep_for(blinkRate);
            myLEDs = 0x19;
            thread_sleep_for(blinkRate);
            myLEDs = 0x21;
            thread_sleep_for(blinkRate);        
            myLEDs = 0x21;
            thread_sleep_for(blinkRate);
            myLEDs = 0x21;
            thread_sleep_for(blinkRate);
            myLEDs = 0x11;
            thread_sleep_for(blinkRate);        
            myLEDs = 0x09;
            thread_sleep_for(blinkRate);
            myLEDs = 0x0b;
            thread_sleep_for(blinkRate);
            myLEDs = 0x0c;
            thread_sleep_for(blinkRate); 
        }
    }
}


